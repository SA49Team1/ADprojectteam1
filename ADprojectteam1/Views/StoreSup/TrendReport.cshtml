@using ADprojectteam1.Models;


@{
    ViewBag.Title = "TrendReport";
    string[] months= ViewBag.months;
    int[] cons = ViewBag.cons;
}

<div class="row" style="padding-top:70px;">
    <div class="col-sm-3 col-xs-3 col-lg-3 col-md-3">
        @{
            Html.RenderPartial("_Layout_StoreSup_LeftBar");
        }
    </div>

    <div class="w3-main" style="margin-left:250px">
        <h2>TrendReport</h2>
        <table class="w3-table w3-striped">
        <tr>@{ for (int i = 0; i < months.Length; i++)
            {<td><span  id="months @i"  >@months[i]</span></td>}
            }
        </tr>
        <tr>
            @{ for (int i = 0; i < cons.Length; i++)
                {
                    <td><span id="cons @i"  >@cons[i]</span></td>
}
                }
            </tr>
        </table>
            <input type="button" value="DrawChart" onclick="drawchart(@months.Length)" />

            <!-- Styles -->
            <style>
                #chartdiv {
                    width: 100%;
                    height: 500px;
                }
            </style>

            <!-- Resources -->
            <script src="https://www.amcharts.com/lib/4/core.js"></script>
            <script src="https://www.amcharts.com/lib/4/charts.js"></script>
            <script src="https://www.amcharts.com/lib/4/themes/animated.js"></script>

            <!-- Chart code -->
            <script>
                function drawchart(length) {
                    


                    // Themes begin
                    am4core.useTheme(am4themes_animated);
                    // Themes end

                    // Create chart instance
                    var chart = am4core.create("chartdiv", am4charts.XYChart);
                    chart.scrollbarX = new am4core.Scrollbar();


                    // Add data
                    for (x = 0; x < length; x++) {
                        
                        var m = document.getElementById("months " + x).innerHTML
                        
                        var c = parseInt(document.getElementById("cons " + x).innerHTML)
                        
                        var obj = { "date": m, "cons": c };
                        chart.data.push(obj);
                        
                    }


                    // Create axes
                    var categoryAxis = chart.xAxes.push(new am4charts.CategoryAxis());
                    categoryAxis.dataFields.category = "date";
                    categoryAxis.renderer.grid.template.location = 0;
                    categoryAxis.renderer.minGridDistance = 30;
                    categoryAxis.renderer.labels.template.horizontalCenter = "right";
                    categoryAxis.renderer.labels.template.verticalCenter = "middle";
                    categoryAxis.renderer.labels.template.rotation = 270;
                    categoryAxis.tooltip.disabled = true;
                    categoryAxis.renderer.minHeight = 110;

                    var valueAxis = chart.yAxes.push(new am4charts.ValueAxis());
                    valueAxis.renderer.minWidth = 50;

                    // Create series
                    var series = chart.series.push(new am4charts.ColumnSeries());
                    series.sequencedInterpolation = true;
                    series.dataFields.valueY = "cons";
                    series.dataFields.categoryX = "date";
                    series.tooltipText = "[{categoryX}: bold]{valueY}[/]";
                    series.columns.template.strokeWidth = 0;

                    series.tooltip.pointerOrientation = "vertical";

                    series.columns.template.column.cornerRadiusTopLeft = 10;
                    series.columns.template.column.cornerRadiusTopRight = 10;
                    series.columns.template.column.fillOpacity = 0.8;

                    // on hover, make corner radiuses bigger
                    var hoverState = series.columns.template.column.states.create("hover");
                    hoverState.properties.cornerRadiusTopLeft = 0;
                    hoverState.properties.cornerRadiusTopRight = 0;
                    hoverState.properties.fillOpacity = 1;

                    series.columns.template.adapter.add("fill", function (fill, target) {
                        return chart.colors.getIndex(target.dataItem.index);
                    });

                    // Cursor
                    chart.cursor = new am4charts.XYCursor();

                }; // end am4core.ready()
            </script>

            <!-- HTML -->
            <div id="chartdiv"></div>


            <br>
            <br>
    </div>
</div>

<script>
    function rejectInvAdj(invadj_id) {




        var remark = document.getElementById("remarkbox " + invadj_id).value

        var pdata = { InvAdjId: invadj_id, remark: remark };

        $.ajax({
            type: "POST",
            url: "/StoreSup/rejectInvAdj",
            contentType: "application/json; charset=utf-8",
            data: JSON.stringify(pdata),
            dataType: "json",

            // Response Success
            success: function (response) {

                alert("Rejected Inventory Adjustment successfully");
                window.location.href = "./PendingInvAdjList";

            },

            // Response Fail
            failure: function (response) {
                alert("Fail Case");
            },

            // Response Error
            error: function (response) {
                alert("ERROR case");
            }


        });
    }

    function approveInvAdj(invadj_id) {




        var remark = document.getElementById("remarkbox " + invadj_id).value

        var pdata = { InvAdjId: invadj_id, remark: remark };

        $.ajax({
            type: "POST",
            url: "/StoreSup/approveInvAdj",
            contentType: "application/json; charset=utf-8",
            data: JSON.stringify(pdata),
            dataType: "json",

            // Response Success
            success: function (response) {

                alert("Approved Inventory Adjustment successfully");
                window.location.href = "./PendingInvAdjList";

            },

            // Response Fail
            failure: function (response) {
                alert("Fail Case");
            },

            // Response Error
            error: function (response) {
                alert("ERROR case");
            }


        });
    }
</script>







